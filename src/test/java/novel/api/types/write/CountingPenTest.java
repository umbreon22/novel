package novel.api.types.write;

import novel.api.Novel;
import novel.api.types.adapt.NovelableWrapper;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;

class CountingPenTest {

    @Test
    void testPrimitives() {
        testWrappedData((byte) 1, Byte.BYTES);
        testWrappedData((short) 2, Short.BYTES);
        testWrappedData(3, Integer.BYTES);
        testWrappedData(4L, Long.BYTES);
        testWrappedData(5d, Double.BYTES);
        testWrappedData(6f, Float.BYTES);
        testWrappedData(false, Byte.BYTES);
        testWrappedData('a', Character.BYTES);
    }

    @Test
    void testString() {
        String str = "abc";
        testWrappedData(str, str.length()+Short.BYTES);
    }

    private <T> void testWrappedData(T data, int expectedSize) {
        CountingPen pen = new CountingPen();
        newNovelInstance().write(pen, NovelableWrapper.of(data));
        Assertions.assertEquals(pen.count(), expectedSize);
    }

    private static Novel newNovelInstance() {
        return Novel.newBuilder().build();
    }
}
